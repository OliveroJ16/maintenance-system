<div class="header">
    <div class="header-left">
        <h1 id="pageTitle">Vehículos</h1>
        <p id="pageDescription">Administración de vehículos de la flota</p>
    </div>
</div>

<div class="content-area">
    <div class="section-card">

        <!-- TÍTULO -->
        <div class="section-header">
            <div class="section-title">
                <h2>Gestión de Vehículos</h2>
                <p>Consultar, registrar y administrar vehículos</p>
            </div>

            <button class="btn btn-primary" onclick="openVehicleModal()">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                </svg>
                Nuevo Vehículo
            </button>
        </div>

        <!-- BUSCADOR -->
        <div class="search-bar">
            <input type="text" placeholder="Buscar vehículo..." onkeyup="searchVehicles(this.value)">
        </div>

        <div class="table-container">
            <table id="vehiclesTable">
                <thead>
                    <tr>
                        <th>Placa</th>
                        <th>Marca</th>
                        <th>Modelo</th>
                        <th>Tipo</th>
                        <th>Kilometraje</th>
                        <th>Combustible</th>
                        <th>Estado</th>
                        <th>Acciones</th>
                    </tr>
                </thead>

                <tbody>
                    <tr th:each="v : ${vehicles}">
                        <td th:text="${v.plate}"></td>
                        <td th:text="${v.brand}"></td>
                        <td th:text="${v.model}"></td>
                        <td th:text="${v.vehicleType}"></td>
                        <td th:text="${v.mileage}"></td>
                        <td th:text="${v.fuelType}"></td>

                        <td>
                            <span class="status-badge" 
                                  th:classappend="${v.status == 'ACTIVO'} ? 'activo' : 'inactivo'"
                                  th:text="${v.status}">
                                Activo
                            </span>
                        </td>

                        <td>
                            <div class="action-buttons">

                                <!-- boton editar-->
                                <button class="icon-btn edit"
                                        onclick="editVehicle(this)"
                                        th:data-id="${v.idVehicle}"
                                        th:data-plate="${v.plate}"
                                        th:data-brand="${v.brand}"
                                        th:data-model="${v.model}"
                                        th:data-vehicletype="${v.vehicleType}"
                                        th:data-serialnumber="${v.serialNumber}"
                                        th:data-mileage="${v.mileage}"
                                        th:data-fueltype="${v.fuelType}"
                                        th:data-status="${v.status}"
                                        th:data-acquisitiondate="${v.acquisitionDate}">
                                    <svg width="18" height="18" fill="none" stroke="currentColor"
                                         viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5
                                                 m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828
                                                 l8.586-8.586z" />
                                    </svg>
                                </button>

                                <!-- boton eliminar -->
                                <button class="icon-btn delete"
                                        th:onclick="'confirmDeleteVehicle(' + ${v.idVehicle} + ')'">
                                    <svg width="18" height="18" fill="none" stroke="currentColor"
                                         viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                              d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862
                                                 a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4
                                                 a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                                    </svg>
                                </button>

                            </div>
                        </td>
                    </tr>
                </tbody>

            </table>
        </div>
    </div>
</div>

<div id="vehicleModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="vehicleModalTitle">Nuevo Vehículo</h3>
            <button class="close-btn" onclick="closeVehicleModal()">&times;</button>
        </div>

        <form id="vehicleForm" th:action="@{/vehiculos}"
              th:object="${newVehicle}" method="post"
              onsubmit="saveVehicle(event)">

            <div class="form-grid">

                <div class="form-group">
                    <label>Placa</label>
                    <input type="text" th:field="*{plate}" required>
                </div>

                <div class="form-group">
                    <label>Número de Serie</label>
                    <input type="text" th:field="*{serialNumber}" required>
                </div>

                <div class="form-group">
                    <label>Marca</label>
                    <input type="text" th:field="*{brand}" required>
                </div>

                <div class="form-group">
                    <label>Modelo</label>
                    <input type="text" th:field="*{model}" required>
                </div>

                <div class="form-group">
                    <label>Tipo</label>
                    <select th:field="*{vehicleType}" required>
                        <option value="SEDAN">Sedán</option>
                        <option value="SUV">SUV</option>
                        <option value="CAMIONETA">Camioneta</option>
                        <option value="VAN">Van</option>
                        <option value="CAMION">Camión</option>
                        <option value="OTRO">Otro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Kilometraje</label>
                    <input type="number" th:field="*{mileage}" required min="0">
                </div>

                <div class="form-group">
                    <label>Combustible</label>
                    <select th:field="*{fuelType}" required>
                        <option value="GASOLINA">Gasolina</option>
                        <option value="DIESEL">Diesel</option>
                        <option value="ELECTRICO">Eléctrico</option>
                        <option value="HIBRIDO">Híbrido</option>
                        <option value="OTRO">Otro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Fecha de Adquisición</label>
                    <input type="date" th:field="*{acquisitionDate}">
                </div>

                <div class="form-group">
                    <label>Estado</label>
                    <select th:field="*{status}" required>
                        <option value="ACTIVO">Activo</option>
                        <option value="INACTIVO">Inactivo</option>
                        <option value="MANTENIMIENTO">En Mantenimiento</option>
                    </select>
                </div>

            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeVehicleModal()">Cancelar</button>
                <button type="submit" class="btn btn-primary">Guardar</button>
            </div>

        </form>
    </div>
</div>

<div id="editVehicleModal" class="modal hidden">
    <div class="modal-content">
        <div class="modal-header">
            <h3>Editar Vehículo</h3>
            <button class="close-btn" onclick="closeEditVehicleModal()">&times;</button>
        </div>

        <form id="editVehicleForm" onsubmit="updateVehicle(event)">
            <input type="hidden" name="idVehicle">

            <div class="form-grid">

                <div class="form-group">
                    <label>Placa</label>
                    <input type="text" name="plate" required>
                </div>

                <div class="form-group">
                    <label>Número de Serie</label>
                    <input type="text" name="serialNumber" required>
                </div>

                <div class="form-group">
                    <label>Marca</label>
                    <input type="text" name="brand" required>
                </div>

                <div class="form-group">
                    <label>Modelo</label>
                    <input type="text" name="model" required>
                </div>

                <div class="form-group">
                    <label>Tipo</label>
                    <select name="vehicleType" required>
                        <option value="SEDAN">Sedán</option>
                        <option value="SUV">SUV</option>
                        <option value="CAMIONETA">Camioneta</option>
                        <option value="VAN">Van</option>
                        <option value="CAMION">Camión</option>
                        <option value="OTRO">Otro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Kilometraje</label>
                    <input type="number" name="mileage" required min="0">
                </div>

                <div class="form-group">
                    <label>Combustible</label>
                    <select name="fuelType" required>
                        <option value="GASOLINA">Gasolina</option>
                        <option value="DIESEL">Diesel</option>
                        <option value="ELECTRICO">Eléctrico</option>
                        <option value="HIBRIDO">Híbrido</option>
                        <option value="OTRO">Otro</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Fecha de Adquisición</label>
                    <input type="date" name="acquisitionDate">
                </div>

                <div class="form-group">
                    <label>Estado</label>
                    <select name="status" required>
                        <option value="ACTIVO">Activo</option>
                        <option value="INACTIVO">Inactivo</option>
                        <option value="MANTENIMIENTO">En Mantenimiento</option>
                    </select>
                </div>

            </div>

            <div class="form-actions">
                <button type="button" class="btn btn-secondary" onclick="closeEditVehicleModal()">Cancelar</button>
                <button type="submit" class="btn btn-primary">Actualizar</button>
            </div>
        </form>
    </div>
</div>